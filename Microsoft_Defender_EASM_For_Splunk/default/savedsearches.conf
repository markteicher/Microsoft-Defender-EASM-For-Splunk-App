# default/savedsearches.conf
# Microsoft Defender EASM for Splunk App
###############################################################################

############################################
# OVERVIEW — ASSET COUNTS
############################################

[EASM - Count Domains]
search = `easm_index` `easm_domains` | stats count AS domain_count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[EASM - Count Hosts]
search = `easm_index` `easm_hosts` | stats count AS host_count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[EASM - Count Pages]
search = `easm_index` `easm_pages` | stats count AS page_count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[EASM - Count SSL Certificates]
search = `easm_index` `easm_ssl_certificates` | stats count AS ssl_certificate_count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[EASM - Count ASNs]
search = `easm_index` `easm_asns` | stats count AS asn_count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[EASM - Count IP Blocks]
search = `easm_index` `easm_ip_blocks` | stats count AS ip_block_count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[EASM - Count IP Addresses]
search = `easm_index` `easm_ip_addresses` | stats count AS ip_address_count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[EASM - Count WHOIS Contacts]
search = `easm_index` `easm_whois_contacts` | stats count AS contact_count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[EASM - Count DNS Records]
search = `easm_index` `easm_dns_records` | stats count AS dns_record_count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

############################################
# OVERVIEW — ATTACK SURFACE INSIGHTS
############################################

[EASM - High Priority Findings]
search = `easm_index` `easm_exposure_insights` severity=High
| stats count AS high_priority_count
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
enableSched = 0

[EASM - Medium Priority Findings]
search = `easm_index` `easm_exposure_insights` severity=Medium
| stats count AS medium_priority_count
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
enableSched = 0

[EASM - Low Priority Findings]
search = `easm_index` `easm_exposure_insights` severity=Low
| stats count AS low_priority_count
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
enableSched = 0

############################################
# INVENTORY — ASSET DISTRIBUTION
############################################

[EASM - Asset Inventory Breakdown]
search = `easm_index` `easm_assets_sourcetypes`
| stats count BY sourcetype
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
enableSched = 0

############################################
# TASKING — TASK STATUS
############################################

[EASM - Tasks by Status]
search = `easm_index` `easm_tasks`
| stats count BY task_status
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
enableSched = 0

############################################
# TRENDS
############################################

[EASM - Asset Growth Over Time]
search = `easm_index` `easm_assets_sourcetypes`
| timechart span=1d count
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
enableSched = 0

############################################
# HEALTH / INGESTION
############################################

[EASM - Ingestion Volume by Sourcetype]
search = `easm_index` `easm_sourcetypes`
| timechart span=1h count BY sourcetype
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0
