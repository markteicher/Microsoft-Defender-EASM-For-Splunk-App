# default/transforms.conf
# Microsoft Defender EASM for Splunk App
###############################################################################

########################################
# CANONICAL EASM RESOURCE ID
########################################

[easm_id]
REGEX = \"id\"\s*:\s*\"(/subscriptions/[^\"]+)\"
FORMAT = easm_id::$1

########################################
# ASSET TYPE (WHEN NOT FLATTENED)
########################################

[easm_asset_type]
REGEX = \"assetType\"\s*:\s*\"([^\"]+)\"
FORMAT = asset_type::$1

########################################
# DOMAIN NAME (NESTED PAYLOADS)
########################################

[easm_domain]
REGEX = \"domain\"\s*:\s*\"([^\"]+)\"
FORMAT = domain::$1

########################################
# HOST NAME (DISCOVERY / TASK PAYLOADS)
########################################

[easm_host]
REGEX = \"hostName\"\s*:\s*\"([^\"]+)\"
FORMAT = host::$1

########################################
# IP ADDRESS (EXPOSURE / FINDINGS)
########################################

[easm_ip_address]
REGEX = \"ipAddress\"\s*:\s*\"([^\"]+)\"
FORMAT = ip_address::$1

########################################
# ASN (NUMERIC)
########################################

[easm_asn]
REGEX = \"asn\"\s*:\s*(\d+)
FORMAT = asn::$1

########################################
# SSL CERTIFICATE FINGERPRINT
########################################

[easm_cert_fingerprint]
REGEX = \"fingerprint\"\s*:\s*\"([^\"]+)\"
FORMAT = ssl_fingerprint::$1

########################################
# WHOIS EMAIL (NESTED CONTACT OBJECTS)
########################################

[easm_whois_email]
REGEX = \"email\"\s*:\s*\"([^\"]+)\"
FORMAT = whois_email::$1

########################################
# SEVERITY / RISK (ONLY IF PRESENT)
########################################

[easm_severity]
REGEX = \"severity\"\s*:\s*\"([^\"]+)\"
FORMAT = severity::$1

[easm_risk_level]
REGEX = \"riskLevel\"\s*:\s*\"([^\"]+)\"
FORMAT = risk_level::$1
