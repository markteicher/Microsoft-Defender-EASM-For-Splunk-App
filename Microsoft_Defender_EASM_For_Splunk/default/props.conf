# default/props.conf
# Microsoft Defender EASM for Splunk App
#
# Purpose:
# - JSON extraction
# - Timestamp normalization
# - Line-breaking control
# - Search-time field consistency
#
# Constraints:
# - All data is JSON
# - No CIM alignment
# - No transforms.conf dependencies
# - Compatible with Splunk Enterprise & Splunk Cloud
###############################################################################

############################
# BASE SETTINGS (ALL EASM)
############################

[defender:easm:*]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 0
KV_MODE = json
INDEXED_EXTRACTIONS = json
NO_BINARY_CHECK = true
CHARSET = UTF-8
TZ = UTC

# Time extraction (applies to all EASM events)
TIME_PREFIX = \"(createdDate|lastUpdatedDate|timestamp|discoveredDate|observedDate)\"\s*:\s*\"
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N
MAX_TIMESTAMP_LOOKAHEAD = 40

############################
# CORE ASSET INVENTORY
############################

[defender:easm:domain]
FIELDALIAS-domain_name = name AS domain
FIELDALIAS-domain_id   = id AS domain_id

[defender:easm:host]
FIELDALIAS-host_name = name AS host
FIELDALIAS-host_id   = id AS host_id

[defender:easm:page]
FIELDALIAS-page_url = name AS url

[defender:easm:ip_address]
FIELDALIAS-ip_value = value AS ip_address

[defender:easm:ip_block]
FIELDALIAS-ip_block_value = value AS ip_block

[defender:easm:asn]
FIELDALIAS-asn_number = number AS asn

[defender:easm:ssl_certificate]
FIELDALIAS-cert_thumbprint = thumbprint AS ssl_thumbprint
FIELDALIAS-cert_subject    = subject AS ssl_subject

[defender:easm:whois_contact]
FIELDALIAS-contact_name  = name AS whois_name
FIELDALIAS-contact_email = email AS whois_email

############################
# ATTACK SURFACE & INSIGHTS
############################

[defender:easm:exposure_insight]
FIELDALIAS-insight_type     = type AS insight_type
FIELDALIAS-insight_severity = severity AS severity

############################
# COMPLIANCE & FRAMEWORKS
############################

[defender:easm:gdpr_compliance]
FIELDALIAS-gdpr_status = status AS gdpr_status

[defender:easm:owasp_top10]
FIELDALIAS-owasp_category = category AS owasp_category

[defender:easm:cwe_top25]
FIELDALIAS-cwe_category = category AS cwe_category

############################
# DISCOVERY & MANAGEMENT
############################

[defender:easm:discovery_template]
FIELDALIAS-template_name = name AS template_name
FIELDALIAS-template_state = provisioning_state AS provisioning_state

[defender:easm:labels]
FIELDALIAS-label_name = label_display_name AS label_name
FIELDALIAS-label_color = label_color AS label_color

[defender:easm:billable_asset]
FIELDALIAS-billable_type = billable_type AS billable_type

[defender:easm:data_connection]
FIELDALIAS-connection_type = type AS connection_type

############################
# TASKS & OPERATIONS
############################

[defender:easm:task]
FIELDALIAS-task_id     = taskId AS task_id
FIELDALIAS-task_status = status AS task_status
FIELDALIAS-task_type   = taskType AS task_type

############################
# PLATFORM HEALTH & LICENSE
############################

[defender:easm:health]
FIELDALIAS-health_status = status AS health_status

[defender:easm:license]
FIELDALIAS-license_expiration = expirationDate AS license_expiration

###############################################################################
# End of file
###############################################################################
