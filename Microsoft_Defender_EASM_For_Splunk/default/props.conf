# default/props.conf
# Microsoft Defender EASM for Splunk App
#
# Purpose:
# - JSON extraction
# - Timestamp normalization
# - Line-breaking control
# - Search-time field consistency
#
# Constraints:
# - All data is JSON
# - No CIM alignment
# - Compatible with Splunk Enterprise & Splunk Cloud
###############################################################################

############################
# BASE SETTINGS (ALL EASM)
############################

[defender:easm:*]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 0
KV_MODE = json
INDEXED_EXTRACTIONS = json
NO_BINARY_CHECK = true
CHARSET = UTF-8
TZ = UTC

# Time extraction (applies to all EASM events)
# NOTE: Splunk supports %Q for fractional seconds (milliseconds)
TIME_PREFIX = \"(createdDate|lastUpdatedDate|timestamp|discoveredDate|observedDate)\"\s*:\s*\"
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%Q
MAX_TIMESTAMP_LOOKAHEAD = 40

# Canonical field normalization (safe aliases; no transforms required)
FIELDALIAS-easm_id          = id AS easm_id
FIELDALIAS-easm_asset_type  = assetType AS asset_type
FIELDALIAS-easm_domain      = domain AS domain
FIELDALIAS-easm_host        = hostName AS host
FIELDALIAS-easm_ip_address  = ipAddress AS ip_address
FIELDALIAS-easm_asn         = asn AS asn
FIELDALIAS-easm_fingerprint = fingerprint AS ssl_fingerprint
FIELDALIAS-easm_severity    = severity AS severity
FIELDALIAS-easm_risk_level  = riskLevel AS risk_level

############################
# CORE ASSET INVENTORY
############################

[defender:easm:domain]
FIELDALIAS-domain_name = name AS domain
FIELDALIAS-domain_id   = id AS domain_id

[defender:easm:host]
FIELDALIAS-host_name = name AS host
FIELDALIAS-host_id   = id AS host_id

[defender:easm:page]
FIELDALIAS-page_url = name AS url

[defender:easm:ip_address]
FIELDALIAS-ip_value = value AS ip_address

[defender:easm:ip_block]
FIELDALIAS-ip_block_value = value AS ip_block

[defender:easm:asn]
FIELDALIAS-asn_number = number AS asn

[defender:easm:ssl_certificate]
FIELDALIAS-cert_thumbprint = thumbprint AS ssl_thumbprint
FIELDALIAS-cert_subject    = subject AS ssl_subject

[defender:easm:whois_contact]
FIELDALIAS-contact_name  = name AS whois_name
FIELDALIAS-contact_email = email AS whois_email

############################
# DNS RECORDS
############################

[defender:easm:dns_record]
FIELDALIAS-dns_record_name  = name AS dns_name
FIELDALIAS-dns_record_type  = recordType AS dns_record_type
FIELDALIAS-dns_record_value = value AS dns_record_value
FIELDALIAS-dns_record_ttl   = ttl AS dns_ttl

############################
# EXPOSURE / ATTACK SURFACE
############################

[defender:easm:exposure_insight]
FIELDALIAS-insight_type = type AS insight_type

############################
# DISCOVERY & TASKING
############################

[defender:easm:discovery_template]
FIELDALIAS-template_name = name AS template_name

[defender:easm:discovery_run]
FIELDALIAS-discovery_run_id = id AS discovery_run_id

[defender:easm:task]
FIELDALIAS-task_id     = taskId AS task_id
FIELDALIAS-task_status = status AS task_status
FIELDALIAS-task_type   = taskType AS task_type

############################
# DATA CONNECTIONS
############################

[defender:easm:data_connection]
FIELDALIAS-connection_id   = id AS connection_id
FIELDALIAS-connection_type = type AS connection_type

[defender:easm:data_connection_validation]
FIELDALIAS-validation_id = id AS validation_id

############################
# REPORTING
############################

[defender:easm:report]
FIELDALIAS-report_id = id AS report_id

[defender:easm:report_output]
FIELDALIAS-report_output_id = id AS report_output_id

############################
# RBAC / CONTROL PLANE
############################

[defender:easm:rbac:role_definition]
FIELDALIAS-role_definition_id = id AS role_definition_id

[defender:easm:rbac:role_assignment]
FIELDALIAS-role_assignment_id = id AS role_assignment_id

[defender:easm:workspace]
FIELDALIAS-workspace_name = name AS workspace_name

[defender:easm:operations]
FIELDALIAS-operation_id = id AS operation_id

[defender:easm:license]
FIELDALIAS-license_expiration = expirationDate AS license_expiration

###############################################################################
# End of file
###############################################################################
