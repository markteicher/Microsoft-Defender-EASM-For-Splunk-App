# default/web.conf
# Microsoft Defender EASM for Splunk App
#
# Purpose:
# - Control Splunk Web exposure for setup, validation, and input management
# - Align strictly with restmap.conf endpoints
# - AppInspect compliant (no unsupported stanzas or keys)
###############################################################################

############################################
# Application Web Settings
############################################

[settings]
# NOTE: Do not control Splunk Web SSL from an app.
# Splunk Web SSL is a global deployment setting (server.conf/web.conf) and is not AppInspect-safe here.

############################################
# App Setup Exposure
############################################

[expose:setup]
methods = GET,POST
pattern = setup

############################################
# REST Endpoint Exposure (Setup & Validation)
############################################

[expose:defender_easm_setup]
methods = GET,POST
pattern = defender_easm/setup

[expose:defender_easm_setup_reload]
methods = POST
pattern = defender_easm/setup/reload

[expose:defender_easm_validate]
methods = GET
pattern = defender_easm/validate

[expose:defender_easm_test_connection]
methods = GET
pattern = defender_easm/test_connection

############################################
# Modular Input Management
############################################

[expose:defender_easm_inputs]
methods = GET,POST
pattern = defender_easm/inputs

[expose:defender_easm_inputs_status]
methods = GET
pattern = defender_easm/inputs/status

[expose:defender_easm_inputs_enable]
methods = POST
pattern = defender_easm/inputs/enable

[expose:defender_easm_inputs_disable]
methods = POST
pattern = defender_easm/inputs/disable

############################################
# Health & Diagnostics
############################################

[expose:defender_easm_health]
methods = GET
pattern = defender_easm/health
