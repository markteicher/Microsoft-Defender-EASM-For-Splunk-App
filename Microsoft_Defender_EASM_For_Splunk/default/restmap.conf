# default/restmap.conf
# Microsoft Defender EASM for Splunk App
###############################################################################

###############################################################################
# Setup & Configuration
###############################################################################

[script:defender_easm_setup]
match = /defender_easm/setup
script = defender_easm_setup_handler.py
scripttype = python
python.version = python3
handleractions = edit,list

[script:defender_easm_setup_reload]
match = /defender_easm/setup/reload
script = defender_easm_setup_handler.py
scripttype = python
python.version = python3
handleractions = reload

###############################################################################
# Validation & Connectivity
###############################################################################

[script:defender_easm_validate]
match = /defender_easm/validate
script = defender_easm_validation.py
scripttype = python
python.version = python3
handleractions = list

[script:defender_easm_test_connection]
match = /defender_easm/test_connection
script = defender_easm_validation.py
scripttype = python
python.version = python3
handleractions = list

###############################################################################
# Modular Input Management
###############################################################################

[script:defender_easm_inputs]
match = /defender_easm/inputs
script = defender_easm_input_handler.py
scripttype = python
python.version = python3
handleractions = list

[script:defender_easm_inputs_status]
match = /defender_easm/inputs/status
script = defender_easm_input_handler.py
scripttype = python
python.version = python3
handleractions = list

[script:defender_easm_inputs_enable]
match = /defender_easm/inputs/enable
script = defender_easm_input_handler.py
scripttype = python
python.version = python3
handleractions = edit

[script:defender_easm_inputs_disable]
match = /defender_easm/inputs/disable
script = defender_easm_input_handler.py
scripttype = python
python.version = python3
handleractions = edit

###############################################################################
# Health & Diagnostics
###############################################################################

[script:defender_easm_health]
match = /defender_easm/health
script = defender_easm_validation.py
scripttype = python
python.version = python3
handleractions = list

###############################################################################
# Backfill & Replay (future-safe)
###############################################################################

[script:defender_easm_backfill]
match = /defender_easm/backfill
script = defender_easm_input_handler.py
scripttype = python
python.version = python3
handleractions = edit
