# default/macros.conf
# Microsoft Defender EASM for Splunk App
#
# Purpose:
# - Provide safe, reusable search fragments
# - Avoid hardcoding index / sourcetypes in dashboards
# - Support user-configurable index design
#
# Design rules:
# - NO logic macros
# - NO eval-heavy macros
# - NO compliance assumptions
# - ONLY field-safe abstractions

############################################
# CORE INDEX MACROS
############################################

[easm_index]
definition = index=security_defender_easm
iseval = 0

############################################
# CORE SOURCETYPE MACROS
############################################

[easm_sourcetypes]
definition = sourcetype=defender:easm:*
iseval = 0

[easm_assets_sourcetypes]
definition = sourcetype IN (
    defender:easm:domain,
    defender:easm:host,
    defender:easm:page,
    defender:easm:ip_address,
    defender:easm:ip_block,
    defender:easm:asn,
    defender:easm:ssl_certificate,
    defender:easm:whois_contact
)
iseval = 0

############################################
# ASSET TYPE FILTER MACROS
############################################

[easm_domains]
definition = sourcetype=defender:easm:domain
iseval = 0

[easm_hosts]
definition = sourcetype=defender:easm:host
iseval = 0

[easm_pages]
definition = sourcetype=defender:easm:page
iseval = 0

[easm_ip_addresses]
definition = sourcetype=defender:easm:ip_address
iseval = 0

[easm_ip_blocks]
definition = sourcetype=defender:easm:ip_block
iseval = 0

[easm_asns]
definition = sourcetype=defender:easm:asn
iseval = 0

[easm_ssl_certificates]
definition = sourcetype=defender:easm:ssl_certificate
iseval = 0

[easm_whois_contacts]
definition = sourcetype=defender:easm:whois_contact
iseval = 0

############################################
# DISCOVERY / TASKING
############################################

[easm_tasks]
definition = sourcetype=defender:easm:task
iseval = 0

############################################
# SEVERITY / PRIORITY (ONLY IF PRESENT)
# NOTE: Field names depend on Defender EASM payloads
############################################

[easm_high_severity]
definition = severity=High
iseval = 0

[easm_medium_severity]
definition = severity=Medium
iseval = 0

[easm_low_severity]
definition = severity=Low
iseval = 0

############################################
# TIME SAFETY (DASHBOARD DEFAULTS)
############################################

[easm_last_24h]
definition = earliest=-24h latest=now
iseval = 0

[easm_last_7d]
definition = earliest=-7d@d latest=now
iseval = 0

[easm_last_30d]
definition = earliest=-30d@d latest=now
iseval = 0
