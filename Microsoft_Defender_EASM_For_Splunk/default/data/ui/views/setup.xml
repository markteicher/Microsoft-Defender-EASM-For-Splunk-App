<!-- default/data/ui/views/setup.xml -->
<!-- Microsoft Defender EASM for Splunk App -->
<!-- Setup & Configuration -->

<form version="1.1">
  <label>Setup</label>

  <description>
    Configure Microsoft Defender External Attack Surface Management (EASM)
    API access, workspace scope, and ingestion settings.
  </description>

  <!-- ========================= -->
  <!-- Configuration Inputs -->
  <!-- ========================= -->
  <fieldset submitButton="true">

    <!-- Azure Authentication -->
    <input type="text" token="tenant_id" required="true">
      <label>Azure Tenant ID</label>
    </input>

    <input type="text" token="subscription_id" required="true">
      <label>Azure Subscription ID</label>
    </input>

    <input type="text" token="resource_group" required="true">
      <label>Resource Group Name</label>
    </input>

    <input type="text" token="workspace_name" required="true">
      <label>Defender EASM Workspace Name</label>
    </input>

    <input type="text" token="client_id" required="true">
      <label>Azure Client (Application) ID</label>
    </input>

    <input type="password" token="client_secret" required="true">
      <label>Azure Client Secret</label>
    </input>

    <!-- Authority -->
    <input type="text" token="authority_url">
      <label>Azure Authority URL</label>
      <default>https://login.microsoftonline.com</default>
    </input>

    <!-- Index Configuration -->
    <input type="text" token="target_index">
      <label>Target Index</label>
      <default>security_defender_easm</default>
    </input>

    <!-- Proxy Configuration -->
    <input type="checkbox" token="use_proxy">
      <label>Proxy Configuration</label>
      <choice value="true">Enable Proxy</choice>
    </input>

    <input type="text" token="proxy_url" depends="$use_proxy$">
      <label>Proxy URL</label>
    </input>

    <input type="text" token="proxy_username" depends="$use_proxy$">
      <label>Proxy Username</label>
    </input>

    <input type="password" token="proxy_password" depends="$use_proxy$">
      <label>Proxy Password</label>
    </input>

  </fieldset>

  <!-- ========================= -->
  <!-- Submit Handler -->
  <!-- ========================= -->
  <row>
    <panel>
      <html>
        <p>
          Click <strong>Submit</strong> to save configuration and enable
          Microsoft Defender EASM data collection.
        </p>
      </html>
    </panel>
  </row>

</form>
