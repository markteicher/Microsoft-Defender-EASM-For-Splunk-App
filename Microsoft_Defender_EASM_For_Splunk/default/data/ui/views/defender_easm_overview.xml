<!-- defender_easm_overview.xml -->
<!-- Microsoft Defender EASM for Splunk App -->
<!-- Overview Dashboard -->

<dashboard version="1.1">
  <label>Overview</label>
  <description>
    High-level inventory and attack surface insights derived from Microsoft Defender External Attack Surface Management.
  </description>

  <!-- ========================= -->
  <!-- BASE SEARCHES -->
  <!-- ========================= -->

  <search id="base_domains">
    <query>
      `easm_index` `easm_domains`
    </query>
    <earliest>-30d@d</earliest>
    <latest>now</latest>
  </search>

  <search id="base_hosts">
    <query>
      `easm_index` `easm_hosts`
    </query>
    <earliest>-30d@d</earliest>
    <latest>now</latest>
  </search>

  <search id="base_pages">
    <query>
      `easm_index` `easm_pages`
    </query>
    <earliest>-30d@d</earliest>
    <latest>now</latest>
  </search>

  <search id="base_ssl_certificates">
    <query>
      `easm_index` `easm_ssl_certificates`
    </query>
    <earliest>-30d@d</earliest>
    <latest>now</latest>
  </search>

  <search id="base_asns">
    <query>
      `easm_index` `easm_asns`
    </query>
    <earliest>-30d@d</earliest>
    <latest>now</latest>
  </search>

  <search id="base_ip_blocks">
    <query>
      `easm_index` `easm_ip_blocks`
    </query>
    <earliest>-30d@d</earliest>
    <latest>now</latest>
  </search>

  <search id="base_ip_addresses">
    <query>
      `easm_index` `easm_ip_addresses`
    </query>
    <earliest>-30d@d</earliest>
    <latest>now</latest>
  </search>

  <search id="base_whois_contacts">
    <query>
      `easm_index` `easm_whois_contacts`
    </query>
    <earliest>-30d@d</earliest>
    <latest>now</latest>
  </search>

  <search id="base_exposure_insights">
    <query>
      `easm_index`
      sourcetype=defender:easm:exposure_insight
    </query>
    <earliest>-30d@d</earliest>
    <latest>now</latest>
  </search>

  <!-- ===================================================== -->
  <!-- ASSET INVENTORY SUMMARY -->
  <!-- ===================================================== -->

  <row>
    <panel>
      <title>Domains</title>
      <single>
        <search base="base_domains">
          <query>| stats count</query>
        </search>
      </single>
    </panel>

    <panel>
      <title>Hosts</title>
      <single>
        <search base="base_hosts">
          <query>| stats count</query>
        </search>
      </single>
    </panel>

    <panel>
      <title>Pages</title>
      <single>
        <search base="base_pages">
          <query>| stats count</query>
        </search>
      </single>
    </panel>

    <panel>
      <title>SSL Certificates</title>
      <single>
        <search base="base_ssl_certificates">
          <query>| stats count</query>
        </search>
      </single>
    </panel>
  </row>

  <row>
    <panel>
      <title>ASNs</title>
      <single>
        <search base="base_asns">
          <query>| stats count</query>
        </search>
      </single>
    </panel>

    <panel>
      <title>IP Blocks</title>
      <single>
        <search base="base_ip_blocks">
          <query>| stats count</query>
        </search>
      </single>
    </panel>

    <panel>
      <title>IP Addresses</title>
      <single>
        <search base="base_ip_addresses">
          <query>| stats count</query>
        </search>
      </single>
    </panel>

    <panel>
      <title>WHOIS Contacts</title>
      <single>
        <search base="base_whois_contacts">
          <query>| stats count</query>
        </search>
      </single>
    </panel>
  </row>

  <!-- ===================================================== -->
  <!-- ATTACK SURFACE INSIGHTS -->
  <!-- ===================================================== -->

  <row>
    <panel>
      <title>High Priority Findings</title>
      <single>
        <search base="base_exposure_insights">
          <query>
            | search severity=High
            | stats count
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>Medium Priority Findings</title>
      <single>
        <search base="base_exposure_insights">
          <query>
            | search severity=Medium
            | stats count
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>Low Priority Findings</title>
      <single>
        <search base="base_exposure_insights">
          <query>
            | search severity=Low
            | stats count
          </query>
        </search>
      </single>
    </panel>
  </row>

</dashboard>
