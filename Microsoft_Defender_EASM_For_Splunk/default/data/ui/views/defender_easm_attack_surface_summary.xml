<!-- defender_easm_attack_surface_summary.xml -->
<!-- Microsoft Defender EASM for Splunk App -->
<!-- Attack Surface Summary -->

<dashboard version="1.1">
  <label>Attack Surface Summary</label>

  <description>
    Summary of exposure insights and attack surface risk derived from
    Microsoft Defender External Attack Surface Management.
  </description>

  <!-- ===================================================== -->
  <!-- OVERALL EXPOSURE SUMMARY -->
  <!-- ===================================================== -->

  <row>
    <panel>
      <title>Total Exposure Insights</title>
      <single>
        <search>
          <query>
            `easm_index`
            sourcetype=defender:easm:exposure_insight
            | stats count
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>High Severity</title>
      <single>
        <search>
          <query>
            `easm_index`
            sourcetype=defender:easm:exposure_insight
            severity=High
            | stats count
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>Medium Severity</title>
      <single>
        <search>
          <query>
            `easm_index`
            sourcetype=defender:easm:exposure_insight
            severity=Medium
            | stats count
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>Low Severity</title>
      <single>
        <search>
          <query>
            `easm_index`
            sourcetype=defender:easm:exposure_insight
            severity=Low
            | stats count
          </query>
        </search>
      </single>
    </panel>
  </row>

  <!-- ===================================================== -->
  <!-- EXPOSURE BY ASSET TYPE -->
  <!-- ===================================================== -->

  <row>
    <panel>
      <title>Exposure by Asset Type</title>
      <chart>
        <search>
          <query>
            `easm_index`
            sourcetype=defender:easm:exposure_insight
            | stats count by asset_type
            | sort - count
          </query>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
  </row>

  <!-- ===================================================== -->
  <!-- EXPOSURE TREND -->
  <!-- ===================================================== -->

  <row>
    <panel>
      <title>Exposure Trend Over Time</title>
      <chart>
        <search>
          <query>
            `easm_index`
            sourcetype=defender:easm:exposure_insight
            | timechart span=1d count by severity
          </query>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
  </row>

  <!-- ===================================================== -->
  <!-- TOP RISK DRIVERS -->
  <!-- ===================================================== -->

  <row>
    <panel>
      <title>Top Exposure Categories</title>
      <table>
        <search>
          <query>
            `easm_index`
            sourcetype=defender:easm:exposure_insight
            | stats count by category
            | sort - count
            | head 10
          </query>
        </search>
        <option name="count">10</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>

</dashboard>
