<dashboard version="1.1">
  <label>OWASP Top 10</label>

  <!-- ========================= -->
  <!-- OWASP Summary Metrics -->
  <!-- ========================= -->
  <row>
    <panel>
      <title>Total OWASP Findings</title>
      <single>
        <search>
          <query>
            index=security_defender_easm sourcetype=defender:easm:findings owaspCategory=*
            | stats count
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>Critical OWASP Findings</title>
      <single>
        <search>
          <query>
            index=security_defender_easm sourcetype=defender:easm:findings owaspCategory=* severity=critical
            | stats count
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>High OWASP Findings</title>
      <single>
        <search>
          <query>
            index=security_defender_easm sourcetype=defender:easm:findings owaspCategory=* severity=high
            | stats count
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>Assets Impacted</title>
      <single>
        <search>
          <query>
            index=security_defender_easm sourcetype=defender:easm:findings owaspCategory=*
            | stats dc(assetId)
          </query>
        </search>
      </single>
    </panel>
  </row>

  <!-- ========================= -->
  <!-- OWASP Findings by Category -->
  <!-- ========================= -->
  <row>
    <panel>
      <title>OWASP Top 10 Findings by Category</title>
      <chart>
        <search>
          <query>
            index=security_defender_easm sourcetype=defender:easm:findings owaspCategory=*
            | stats count by owaspCategory
            | sort owaspCategory
          </query>
        </search>
        <option name="charting.chart">bar</option>
      </chart>
    </panel>
  </row>

  <!-- ========================= -->
  <!-- OWASP Severity Distribution -->
  <!-- ========================= -->
  <row>
    <panel>
      <title>OWASP Findings by Severity</title>
      <chart>
        <search>
          <query>
            index=security_defender_easm sourcetype=defender:easm:findings owaspCategory=*
            | stats count by severity
          </query>
        </search>
        <option name="charting.chart">pie</option>
      </chart>
    </panel>
  </row>

  <!-- ========================= -->
  <!-- OWASP Findings Trend -->
  <!-- ========================= -->
  <row>
    <panel>
      <title>OWASP Risk Trend</title>
      <chart>
        <search>
          <query>
            index=security_defender_easm sourcetype=defender:easm:findings owaspCategory=*
            | timechart span=1d count by severity
          </query>
        </search>
        <option name="charting.chart">line</option>
      </chart>
    </panel>
  </row>

  <!-- ========================= -->
  <!-- Top Affected Assets -->
  <!-- ========================= -->
  <row>
    <panel>
      <title>Top Assets by OWASP Exposure</title>
      <table>
        <search>
          <query>
            index=security_defender_easm sourcetype=defender:easm:findings owaspCategory=*
            | stats count by assetName owaspCategory
            | sort - count
            | head 15
          </query>
        </search>
      </table>
    </panel>
  </row>

</dashboard>
